INGRES TERMINAL MONITOR -- Copyright (c) 1981, 1991 Actian Corporation
/* SQL Startup File */
/* 
**  	Brief file of sql queries to demonstrate the use of PNUM, 
**  	a user-defined data type.
**
**  	01-may-92 (stevet)
**  	    Added drop statement before creating view v1.
*/

drop n1

create table n1 (n5 pnum(5) not null, 
    	    	 n10 pnum(10) not null, 
    	    	 n15 pnum(15) not null, 
    	    	 n20 pnum(20) not null, 
                 n25 pnum(25) not null, 
    	    	 n30 pnum(30) not null)

/* Modify table to btree */

modify n1 to btree unique on n5
(0 rows)

help table n1
Name:                 n1
Owner:                stevet
Created:              18-aug-1993 17:00:39     
Location:             ii_database
Type:                 user table
Version:              ING6.0  
Row width:            57
Number of rows:       0
Storage structure:    btree with unique keys
Compression:          none
Duplicate Rows:       not allowed
Number of pages:      5
Overflow data pages:  0
Journaling:           disabled
Base table for view:  no
Permissions:          none
Integrities:          yes
Optimizer statistics: none

Column Information:
                                                                  Key
Column Name                      Type       Length Nulls Defaults Seq
n5                               pnum            3   no      no     1 
n10                              pnum            6   no      no       
n15                              pnum            8   no      no       
n20                              pnum           11   no      no       
n25                              pnum           13   no      no       
n30                              pnum           16   no      no       

Secondary indexes:    none




/* Create an index on n1 */

create index n1idx on n1 (n30, n25)
(0 rows)

drop n2

help index n1idx
Name:                 n1idx
Owner:                stevet
Created:              18-aug-1993 17:00:47     
Location:             ii_database
Type:                 secondary index on n1
Version:              ING6.0  
Row width:            33
Number of rows:       0
Storage structure:    isam
Compression:          none
Duplicate Rows:       allowed
Number of pages:      4
Overflow data pages:  0
Journaling:           enabled if journaling on the base table is enabled
Base table for view:  no
Permissions:          none
Integrities:          none
Optimizer statistics: will use any existing statistics on the base table

Index Column Information:
                                                                  Key
Column Name                      Type       Length Nulls Defaults Seq
n30                              pnum           16   no      no     1 
n25                              pnum           13   no      no     2 
tidp                             integer         4   no      no     3 





/* This create should failed because of invalid length */

create table n2 (n35 pnum(35) not null)
E_US07DE CREATE TABLE: invalid column format 'pnum' on column 'n35'.
    (Wed Aug 18 17:00:54 1993)


/* Let's create another table */

create table n2 (n20 pnum(20) not null)

/* Modify n2 to hash */

modify n2 to hash unique on n20
(0 rows)

help table n2
Name:                 n2
Owner:                stevet
Created:              18-aug-1993 17:00:54     
Location:             ii_database
Type:                 user table
Version:              ING6.0  
Row width:            11
Number of rows:       0
Storage structure:    hash with unique keys
Compression:          none
Duplicate Rows:       not allowed
Number of pages:      18
Overflow data pages:  0
Journaling:           disabled
Base table for view:  no
Permissions:          none
Integrities:          yes
Optimizer statistics: none

Column Information:
                                                                  Key
Column Name                      Type       Length Nulls Defaults Seq
n20                              pnum           11   no      no     1 

Secondary indexes:    none




drop v1
E_US0AC1 DROP: 'v1' does not exist or is not owned by you.
    (Wed Aug 18 17:00:58 1993)


/* Create a view for n2 */

create view v1 as select n20 from n2 where n20 > 0

help view v1
View:                 v1
Owner:                stevet
Check option:         off

View Definition:
create view  v1 as select n20 from stevet. n2 where n20 > 0           




drop procedure p1

/* Create a procedure for n2 */

create procedure p1
(val pnum(10) not null) as
begin
    update n2
    set n20 = 9999.99
    where n20 < :val
end;

help procedure p1
Procedure:            p1
Type:                 user object
Owner:                stevet
Created:              18-aug-1993 17:01:09     

Procedure Definition:
create procedure  p1 (val pnum(10) not null) as begin update stevet.  
n2 set n20 = 9999.99 where n20 < :val end                             




delete from n1
(0 rows)

/*
** Insert rows to n1 using different datatypes.  Make sure the implicit 
** coercion worked as advertised 
*/

insert into n1 values (1, float4(22.22), float8(333.33), char('4444.44'), 
pnum('55555.55'), varchar('6666666.66'))
(1 row)

insert into n1 values (-1, float4(-22.22), float8(-333.33), char('-4444.44'), 
pnum('-55555.55'), varchar('-6666666.66'))
(1 row)

insert into n1 values (111, float4(222222.22), float8(33333333333.33), 
char('444444444444444444.44'), pnum('55555555555555555555555.55'), 
varchar('6666666666666666666666666666.66'))
(1 row)

insert into n1 values (-111, float4(-222222.22), float8(-3333333333.33), 
char('-444444444444444444.44'), pnum('-55555555555555555555555.55'), 
varchar('-6666666666666666666666666666.66'))
(1 row)

select * from n1

+-------+-------------+-----------------+-----------------------+---------------------------+---------------------------------+
|n5     |n10          |n15              |n20                    |n25                        |n30                              |
+-------+-------------+-----------------+-----------------------+---------------------------+---------------------------------+
|-111.00|-222222.22   |-3333333333.33   |-444444444444444444.44 |-55555555555555555555555.55|-6666666666666666666666666666.66 |
|-1.00  |-22.22       |-333.33          |-4444.44               |-55555.55                  |-6666666.66                      |
|1.00   |22.22        |333.33           |4444.44                |55555.55                   |6666666.66                       |
|111.00 |222222.22    |33333333333.33   |444444444444444444.44  |55555555555555555555555.55 |6666666666666666666666666666.66  |
+-------+-------------+-----------------+-----------------------+---------------------------+---------------------------------+
(4 rows)

select n5 from n1

+-------+
|n5     |
+-------+
|-111.00|
|-1.00  |
|1.00   |
|111.00 |
+-------+
(4 rows)

update n1 set n5=n5+0.11 where n5 > 0
(2 rows)

select n5 from n1

+-------+
|n5     |
+-------+
|-111.00|
|-1.00  |
|1.11   |
|111.11 |
+-------+
(4 rows)

delete from n1 where n20=-4444.44
(1 row)

select n20 from n1

+-----------------------+
|n20                    |
+-----------------------+
|-444444444444444444.44 |
|4444.44                |
|444444444444444444.44  |
+-----------------------+
(3 rows)
 
/*
** Now we can test the comparison routines by using different 
** comparison operators. First test key column 
*/

select n5 from n1

+-------+
|n5     |
+-------+
|-111.00|
|1.11   |
|111.11 |
+-------+
(3 rows)

select n5 from n1 where n5 >= 1.00 and n5 <= 111.11

+-------+
|n5     |
+-------+
|1.11   |
|111.11 |
+-------+
(2 rows)

/* 
** Should return the same result even though keybld() will fail 
** becasue the input value cannot fit into the key buffer       
*/

select n5 from n1 where n5 >= 1.00 and n5 <= 9999999

+-------+
|n5     |
+-------+
|1.11   |
|111.11 |
+-------+
(2 rows)

select n5 from n1 where n5 < 0

+-------+
|n5     |
+-------+
|-111.00|
+-------+
(1 row)

select n5 from n1 where n5 > 0

+-------+
|n5     |
+-------+
|1.11   |
|111.11 |
+-------+
(2 rows)

select n5 from n1 where n5 = 1.11

+-------+
|n5     |
+-------+
|1.11   |
+-------+
(1 row)

select n5 from n1 where n5 != 1.11

+-------+
|n5     |
+-------+
|-111.00|
|111.11 |
+-------+
(2 rows)

/* Test non-key columns */

select n20, n25 from n1

+-----------------------+---------------------------+
|n20                    |n25                        |
+-----------------------+---------------------------+
|-444444444444444444.44 |-55555555555555555555555.55|
|4444.44                |55555.55                   |
|444444444444444444.44  |55555555555555555555555.55 |
+-----------------------+---------------------------+
(3 rows)

select n20 from n1 where n20 = 4444.44 or n20 = -4444.44

+-----------------------+
|n20                    |
+-----------------------+
|4444.44                |
+-----------------------+
(1 row)

select n20 from n1 where n20 = 4444.45 or n20 = -4444.43

+-----------------------+
|n20                    |
+-----------------------+
+-----------------------+
(0 rows)

select n25 from n1 where n25 = '55555555555555555555555.55' or 
n25 = '-55555555555555555555555.55'

+---------------------------+
|n25                        |
+---------------------------+
|55555555555555555555555.55 |
|-55555555555555555555555.55|
+---------------------------+
(2 rows)

select n25 from n1 where n25 = '55555555555555555555555.54' or 
n25 = '-55555555555555555555555.56'

+---------------------------+
|n25                        |
+---------------------------+
+---------------------------+
(0 rows)
    	
select n25 from n1 where n25 != '55555555555555555555555.55' and 
n25 != '-55555555555555555555555.55'

+---------------------------+
|n25                        |
+---------------------------+
|55555.55                   |
+---------------------------+
(1 row)

select n25 from n1 where n25 != '55555555555555555555555.54' and 
n25 != '-55555555555555555555555.56'

+---------------------------+
|n25                        |
+---------------------------+
|55555555555555555555555.55 |
|-55555555555555555555555.55|
|55555.55                   |
+---------------------------+
(3 rows)

select n25 from n1 where n25 <= '55555555555555555555555.55' and 
n25 >= '-55555555555555555555555.55'

+---------------------------+
|n25                        |
+---------------------------+
|55555555555555555555555.55 |
|-55555555555555555555555.55|
|55555.55                   |
+---------------------------+
(3 rows)

select n25 from n1 where n25 < '55555555555555555555555.55' and 
n25 > '-55555555555555555555555.55'

+---------------------------+
|n25                        |
+---------------------------+
|55555.55                   |
+---------------------------+
(1 row)

/* Now we test the arithmetic operators */

select n5, n10, n15, n20, n25, n30 from n1

+-------+-------------+-----------------+-----------------------+---------------------------+---------------------------------+
|n5     |n10          |n15              |n20                    |n25                        |n30                              |
+-------+-------------+-----------------+-----------------------+---------------------------+---------------------------------+
|-111.00|-222222.22   |-3333333333.33   |-444444444444444444.44 |-55555555555555555555555.55|-6666666666666666666666666666.66 |
|1.11   |22.22        |333.33           |4444.44                |55555.55                   |6666666.66                       |
|111.11 |222222.22    |33333333333.33   |444444444444444444.44  |55555555555555555555555.55 |6666666666666666666666666666.66  |
+-------+-------------+-----------------+-----------------------+---------------------------+---------------------------------+
(3 rows)

select n5 + 1.11, n10 + 22.22, n15 + 333.33, n20 + 4444.44, 
n25 + 55555.55, n30 + 666666.66 from n1

+---------------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+
|col1                             |col2                             |col3                             |col4                             |col5                             |col6                             |
+---------------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+
|-109.89                          |-222200.00                       |-3333333000.00                   |-444444444444440000.00           |-55555555555555555500000.00      |-6666666666666666666666000000.00 |
|2.22                             |44.44                            |666.66                           |8888.88                          |111111.10                        |7333333.32                       |
|112.22                           |222244.44                        |33333333666.66                   |444444444444448888.88            |55555555555555555611111.10       |6666666666666666666667333333.32  |
+---------------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+
(3 rows)

select n5 - 1.11, n10 - 22.22, n15 - 333.33, n20 - 4444.44, 
n25 - 55555.55, n30 - 666666.66 from n1

+---------------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+
|col1                             |col2                             |col3                             |col4                             |col5                             |col6                             |
+---------------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+
|-112.11                          |-222244.44                       |-3333333666.66                   |-444444444444448888.88           |-55555555555555555611111.10      |-6666666666666666666667333333.32 |
|0.00                             |0.00                             |0.00                             |0.00                             |0.00                             |6000000.00                       |
|110.00                           |222200.00                        |33333333000.00                   |444444444444440000.00            |55555555555555555500000.00       |6666666666666666666666000000.00  |
+---------------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+
(3 rows)

select n5 * 1.11, n10 * 1.11, n15 * 1.11, n20 * 1.11, 
n25 * 1.11 from n1

+---------------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+
|col1                             |col2                             |col3                             |col4                             |col5                             |
+---------------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+
|-123.21                          |-246666.66                       |-3699999999.99                   |-493333333333333333.32           |-61666666666666666666666.66      |
|1.23                             |24.66                            |369.99                           |4933.32                          |61666.66                         |
|123.33                           |246666.66                        |36999999999.99                   |493333333333333333.32            |61666666666666666666666.66       |
+---------------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+
(3 rows)

select n5 / 10, n10 / 10, n15 / 10, n20 / 10, 
n25 / 10, n30 / 10 from n1

+-------+-------------+-----------------+-----------------------+---------------------------+---------------------------------+
|col1   |col2         |col3             |col4                   |col5                       |col6                             |
+-------+-------------+-----------------+-----------------------+---------------------------+---------------------------------+
|-11.10 |-22222.22    |-333333333.33    |-44444444444444444.44  |-5555555555555555555555.55 |-666666666666666666666666666.00  |
|0.11   |2.22         |33.33            |444.44                 |5555.55                    |666666.00                        |
|11.11  |22222.22     |3333333333.33    |44444444444444444.44   |5555555555555555555555.55  |666666666666666666666666666.00   |
+-------+-------------+-----------------+-----------------------+---------------------------+---------------------------------+
(3 rows)

delete from n2 
(0 rows)

/* Make sure hashprep() routine do the right thing */

insert into n2 values ('12345678901234567.89')
(1 row)
insert into n2 values ('12345678901234500.00')
(1 row)
insert into n2 values (90.95)
(1 row)

select * from n2

+-----------------------+
|n20                    |
+-----------------------+
|12345678901234500.00   |
|90.95                  |
|12345678901234567.89   |
+-----------------------+
(3 rows)

select n20 from n2 where n20 = '12345678901234567.89'

+-----------------------+
|n20                    |
+-----------------------+
|12345678901234567.89   |
+-----------------------+
(1 row)

/* Try DBPROC */

help procedure p1
Procedure:            p1
Type:                 user object
Owner:                stevet
Created:              18-aug-1993 17:01:09     

Procedure Definition:
create procedure  p1 (val pnum(10) not null) as begin update stevet.  
n2 set n20 = 9999.99 where n20 < :val end                             




execute procedure p1 (val=100)

select * from n2

+-----------------------+
|n20                    |
+-----------------------+
|9999.99                |
|12345678901234500.00   |
|12345678901234567.89   |
+-----------------------+
(3 rows)

/* COPY tests */

copy table n1 () into 'n1.dat'
(3 rows)
(3 rows)

copy table n1 () from 'n1.dat'
(3 rows)

select * from n1

+-------+-------------+-----------------+-----------------------+---------------------------+---------------------------------+
|n5     |n10          |n15              |n20                    |n25                        |n30                              |
+-------+-------------+-----------------+-----------------------+---------------------------+---------------------------------+
|-111.00|-222222.22   |-3333333333.33   |-444444444444444444.44 |-55555555555555555555555.55|-6666666666666666666666666666.66 |
|1.11   |22.22        |333.33           |4444.44                |55555.55                   |6666666.66                       |
|111.11 |222222.22    |33333333333.33   |444444444444444444.44  |55555555555555555555555.55 |6666666666666666666666666666.66  |
+-------+-------------+-----------------+-----------------------+---------------------------+---------------------------------+
(3 rows)

copy table n1 (n5=char(10), n10=char(15), n15=char(20),
    	       n20=char(25), n25=char(30), n30=char(35)) into 'n1.dat'
(3 rows)

delete from n1
(3 rows)

copy table n1 (n5=char(10), n10=char(15), n15=char(20),
    	       n20=char(25), n25=char(30), n30=char(35)) from 'n1.dat'
(3 rows)

select * from n1

+-------+-------------+-----------------+-----------------------+---------------------------+---------------------------------+
|n5     |n10          |n15              |n20                    |n25                        |n30                              |
+-------+-------------+-----------------+-----------------------+---------------------------+---------------------------------+
|-111.00|-222222.22   |-3333333333.33   |-444444444444444444.44 |-55555555555555555555555.55|-6666666666666666666666666666.66 |
|1.11   |22.22        |333.33           |4444.44                |55555.55                   |6666666.66                       |
|111.11 |222222.22    |33333333333.33   |444444444444444444.44  |55555555555555555555555.55 |6666666666666666666666666666.66  |
+-------+-------------+-----------------+-----------------------+---------------------------+---------------------------------+
(3 rows)

/* Test joining two pnum columns from two different tables */

delete from n2
(3 rows)

insert into n2 values (1.11)
(1 row)

insert into n2 values (22.22)
(1 row)

insert into n2 values (999.99)
(1 row)

select * from n2

+-----------------------+
|n20                    |
+-----------------------+
|1.11                   |
|999.99                 |
|22.22                  |
+-----------------------+
(3 rows)

select a.n5, b.n20, a.n5+b.n20, a.n5*b.n20 
from n1 a, n2 b where a.n5 = b.n20

+-------+-----------------------+-----------------------+-----------------------+
|n5     |n20                    |col3                   |col4                   |
+-------+-----------------------+-----------------------+-----------------------+
|1.11   |1.11                   |2.22                   |1.23                   |
+-------+-----------------------+-----------------------+-----------------------+
(1 row)

select a.n10, b.n20, a.n10+b.n20, a.n10*b.n20 
from n1 a, n2 b where a.n10 = b.n20

+-------------+-----------------------+-----------------------+-----------------------+
|n10          |n20                    |col3                   |col4                   |
+-------------+-----------------------+-----------------------+-----------------------+
|22.22        |22.22                  |44.44                  |493.72                 |
+-------------+-----------------------+-----------------------+-----------------------+
(1 row)

/* currency() tests */

delete from n2
(3 rows)

insert into n2 values ('123.45')
(1 row)
insert into n2 values ('1234.56')
(1 row)
insert into n2 values ('1234567890123456.78')
(1 row)

select 'Default', currency( n20) from n2

+-------+----------------------------------------------+
|col1   |col2                                          |
+-------+----------------------------------------------+
|Default|$123.45                                       |
|Default|$1,234,567,890,123,456.78                     |
|Default|$1,234.56                                     |
+-------+----------------------------------------------+
(3 rows)

select 'US', currency( n20, '-cUS$') from n2

+------+----------------------------------------------+
|col1  |col2                                          |
+------+----------------------------------------------+
|US    |US$123.45                                     |
|US    |US$1,234,567,890,123,456.78                   |
|US    |US$1,234.56                                   |
+------+----------------------------------------------+
(3 rows)
 

select 'Sweden', currency( n20, '-cSEK -t. -d,') from n2

+------+----------------------------------------------+
|col1  |col2                                          |
+------+----------------------------------------------+
|Sweden|SEK123,45                                     |
|Sweden|SEK1.234.567.890.123.456,78                   |
|Sweden|SEK1.234,56                                   |
+------+----------------------------------------------+
(3 rows)

select 'France', currency( n20, '-c-F -t. -d,') from n2

+------+----------------------------------------------+
|col1  |col2                                          |
+------+----------------------------------------------+
|France|123,45F                                       |
|France|1.234.567.890.123.456,78F                     |
|France|1.234,56F                                     |
+------+----------------------------------------------+
(3 rows)

select 'Japan', currency( n20, '-cY -s0') from n2

+------+----------------------------------------------+
|col1  |col2                                          |
+------+----------------------------------------------+
|Japan |Y123                                          |
|Japan |Y1,234,567,890,123,456                        |
|Japan |Y1,234                                        |
+------+----------------------------------------------+
(3 rows)

/* fraction() tests */
drop n3

create table n3 (col1 pnum(20))

insert into n3 values ( pnum('17-1/4', '-f/ -d-'))
(1 row)
insert into n3 values ( pnum('17-1/2', '-f/ -d-'))
(1 row)
insert into n3 values ( pnum('18-1/4', '-f/ -d-'))
(1 row)
insert into n3 values ( pnum('18-3/4', '-f/ -d-'))
(1 row)

select fraction( col1) from n3

+-------------------------------+
|col1                           |
+-------------------------------+
|17 1/4                         |
|17 1/2                         |
|18 1/4                         |
|18 3/4                         |
+-------------------------------+
(4 rows)

select fraction( col1, '-d-') from n3

+-------------------------------+
|col1                           |
+-------------------------------+
|17-1/4                         |
|17-1/2                         |
|18-1/4                         |
|18-3/4                         |
+-------------------------------+
(4 rows)

select fraction( col1, '-d-') + ' - 18-1/2 ==>' + 
       fraction( col1 - pnum('18-1/2', '-f/ -d-'), '-d-') from n3

+---------------------------------------------------------------------------+
|col1                                                                       |
+---------------------------------------------------------------------------+
|17-1/4 - 18-1/2 ==>-1-1/4                                                  |
|17-1/2 - 18-1/2 ==>-1                                                      |
|18-1/4 - 18-1/2 ==>-1/4                                                    |
|18-3/4 - 18-1/2 ==>1/4                                                     |
+---------------------------------------------------------------------------+
(4 rows)


/* pnum() tests */ 

drop n4
 
create table n4 (col1 char(34), col2 pnum(20))

insert into n4 select currency(n20), 
pnum( currency(n20)) from n2
(3 rows)

insert into n4 select currency(n20, '-cUS$'), 
pnum( currency(n20, '-cUS$'), '-cUS$') from n2
(3 rows)

insert into n4 select currency(n20, '-cSEK -t. -d,'), 
pnum( currency(n20, '-cSEK -t. -d,'), '-cSEK -t. -d,') from n2
(3 rows)

insert into n4 select currency(n20, '-cY -s'), 
pnum( currency(n20, '-cY -s'), '-cY -s') from n2
(3 rows)

select * from n4

+----------------------------------+-----------------------+
|col1                              |col2                   |
+----------------------------------+-----------------------+
|$123.45                           |123.45                 |
|$1,234,567,890,123,456.78         |1234567890123456.78    |
|$1,234.56                         |1234.56                |
|US$123.45                         |123.45                 |
|US$1,234,567,890,123,456.78       |1234567890123456.78    |
|US$1,234.56                       |1234.56                |
|SEK123,45                         |123.45                 |
|SEK1.234.567.890.123.456,78       |1234567890123456.78    |
|SEK1.234,56                       |1234.56                |
|Y123                              |123.00                 |
|Y1,234,567,890,123,456            |1234567890123456.00    |
|Y1,234                            |1234.00                |
+----------------------------------+-----------------------+
(12 rows)
